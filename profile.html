<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil - INPT Gym</title>
    <style>
        /* Votre CSS reste inchangé */
        body {
            background: linear-gradient(135deg, #008599, #005a64);
            color: #fff;
            font-family: 'Calibri', sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        .profile__container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        .profile__header {
            text-align: center;
            margin-bottom: 2rem;
        }
        .profile__header h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        .profile__header p {
            font-size: 1.2rem;
            color: #ddd;
        }
        .profile__grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        .profile__section {
            background: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 10px;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }
        .profile__section h2 {
            font-size: 1.8rem;
            margin-bottom: 1rem;
            color: #ff6f61;
        }
        .profile__section label {
            font-weight: bold;
            display: block;
            margin-bottom: 0.5rem;
        }
        .profile__section input, .profile__section select, .profile__section textarea {
            width: calc(100% - 0.3rem); /* Réduit la largeur pour laisser de l'espace à droite */
            margin-right: 0.3rem; /* Ajoute une marge à droite */
            padding: 0.75rem;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
            margin-bottom: 1rem;
            box-sizing: border-box; /* Inclut le padding dans la largeur */
        }
        .profile__section input::placeholder, .profile__section textarea::placeholder {
            color: #ddd;
        }
        .profile__section button {
            background: #ff6f61;
            color: #fff;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s ease;
        }
        .profile__section button:hover {
            background: #ff3b2f;
        }
        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        .calendar__day {
            background: rgba(255, 255, 255, 0.2);
            padding: 1rem;
            text-align: center;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .calendar__day:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        .calendar__day.selected {
            background: #ff6f61;
        }
        .activities {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .activity {
            background: rgba(255, 255, 255, 0.2);
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .activity:hover {
            transform: translateY(-5px);
        }
        .activity h3 {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }
        .activity p {
            font-size: 0.9rem;
            color: #ddd;
        }
        .activity.selected {
            background: #ff6f61; /* Rouge */
            color: #fff; /* Texte blanc */
        }
        @media (max-width: 768px) {
            .profile__grid {
                grid-template-columns: 1fr;
            }
        }
        .calendar__label {
            font-size: 1.5rem;
            color: #ff6f61;
            margin-bottom: 0.5rem;
            grid-column: span 7; /* Prend toute la largeur du calendrier */
        }
    </style>
</head>
<body>
    <div class="profile__container">
        <!-- En-tête du profil -->
        <div class="profile__header">
            <h1>Mon Profil</h1>
            <p>Gérez vos préférences, vos objectifs et vos activités.</p>
        </div>

        <!-- Grille des sections -->
        <div class="profile__grid">
            <!-- Section 1 : Horaires -->
            <div class="profile__section">
                <h2>Horaires Disponibles</h2>
                <div class="calendar">
                    <div class="calendar__day">Lun</div>
                    <div class="calendar__day">Mar</div>
                    <div class="calendar__day">Mer</div>
                    <div class="calendar__day">Jeu</div>
                    <div class="calendar__day">Ven</div>
                    <div class="calendar__day">Sam</div>
                    <div class="calendar__day">Dim</div>

                    <!-- Indicateur pour les horaires des hommes -->
                    <div class="calendar__label">Horaires pour les hommes :</div>
                    <!-- Exemple de jours sélectionnables pour les hommes -->
                    <div class="calendar__day">7h-11h</div>
                    <div class="calendar__day">14h-18h</div>
                    <div class="calendar__day">7h-11h</div>
                    <div class="calendar__day">14h-18h</div>
                    <div class="calendar__day">7h-11h</div>
                    <div class="calendar__day">14h-18h</div>
                    <div class="calendar__day">7h-11h</div>

                    <!-- Indicateur pour les horaires des femmes -->
                    <div class="calendar__label">Horaires pour les femmes :</div>
                    <!-- Exemple de jours sélectionnables pour les femmes -->
                    <div class="calendar__day">14h-18h</div>
                    <div class="calendar__day">7h-11h</div>
                    <div class="calendar__day">14h-18h</div>
                    <div class="calendar__day">7h-11h</div>
                    <div class="calendar__day">14h-18h</div>
                    <div class="calendar__day">7h-11h</div>
                    <div class="calendar__day">14h-18h</div>
                </div>
                <button id="sauvegarder-horaires">Sauvegarder les horaires</button>
            </div>

            <!-- Section 2 : Activités -->
            <div class="profile__section">
                <h2>Activités Proposées</h2>
                <div class="activities">
                    <div class="activity" data-activite-id="1">
                        <h3>Cardio</h3>
                        <p>Brûlez des calories et améliorez votre endurance.</p>
                    </div>
                    <div class="activity" data-activite-id="2">
                        <h3>Musculation</h3>
                        <p>Développez votre force et votre masse musculaire.</p>
                    </div>
                    <div class="activity" data-activite-id="3">
                        <h3>Yoga</h3>
                        <p>Relaxez-vous et améliorez votre flexibilité.</p>
                    </div>
                </div>
                <button id="choisir-activite">Choisir une activité</button>
                <p>Besoin d'aide pour vos exercices ? <a href="how-to-train.html">Consultez How to Train</a></p>
            </div>

            <!-- Section 3 : Objectif Hebdomadaire -->
            <div class="profile__section">
                <h2>Objectif Hebdomadaire</h2>
                <label for="weekly-goal">Nombre de séances par semaine :</label>
                <input type="number" id="nombre_seances" name="weekly-goal" min="1" max="7" placeholder="Ex: 3">
                
                <label for="calories-goal">Calories à brûler :</label>
                <input type="number" id="calories_a_bruler" name="calories-goal" placeholder="Ex: 2000">
                
                <button id="definir-objectif">Définir l'objectif</button>
            </div>

            <!-- Section 4 : Objectif de Santé -->
            <div class="profile__section">
                <h2>Objectif de Santé</h2>
                <label for="health-goal">Choisissez votre objectif :</label>
                <select id="objectif_sante" name="health-goal">
                    <option value="perdre du poids">Perdre du poids</option>
                    <option value="gagner en muscle">Gagner en muscle</option>
                    <option value="améliorer l'endurance">Améliorer l'endurance</option>
                    <option value="réduire le stress">Réduire le stress</option>
                </select>
                
                <label for="notes">Notes supplémentaires :</label>
                <textarea id="notes" name="notes" rows="3" placeholder="Ex: Je veux me concentrer sur les jambes..."></textarea>
                
                <button id="enregistrer-objectif">Enregistrer l'objectif</button>
            </div>

            <!-- Section : Calcul du BMI et Calories -->
            <div class="profile__section">
                <h2>Calculateur BMI & Calories</h2>

                <label for="gender">Genre :</label>
                <select id="gender">
                    <option value="male">Homme</option>
                    <option value="female">Femme</option>
                </select>

                <label for="weight">Poids (kg) :</label>
                <input type="number" id="weight" placeholder="Ex : 70" min="30" max="300">

                <label for="height">Taille (cm) :</label>
                <input type="number" id="height" placeholder="Ex : 170" min="100" max="250">

                <label for="age">Âge :</label>
                <input type="number" id="age" placeholder="Ex : 25" min="10" max="120">

                <label for="activity">Niveau d'activité :</label>
                <select id="activity">
                    <option value="1.2">Sédentaire (peu ou pas d'exercice)</option>
                    <option value="1.375">Légèrement actif (exercice léger 1-3 jours/semaine)</option>
                    <option value="1.55">Modérément actif (exercice modéré 3-5 jours/semaine)</option>
                    <option value="1.725">Très actif (exercice intense 6-7 jours/semaine)</option>
                    <option value="1.9">Extrêmement actif (travail physique ou entraînement intense)</option>
                </select>

                <button id="calculate">Calculer</button>

                <div id="results" style="margin-top: 1.5rem;">
                    <h3>Résultats :</h3>
                    <p id="bmiResult">BMI : <strong>-</strong></p>
                    <p id="caloriesResult">Calories nécessaires/jour : <strong>-</strong></p>
                </div>
            </div>

            <script>
                document.getElementById('calculate').addEventListener('click', function() {
                    const gender = document.getElementById('gender').value;
                    const weight = parseFloat(document.getElementById('weight').value);
                    const height = parseFloat(document.getElementById('height').value) / 100;
                    const age = parseInt(document.getElementById('age').value);
                    const activityLevel = parseFloat(document.getElementById('activity').value);

                    if (isNaN(weight) || isNaN(height) || isNaN(age)) {
                        alert('Veuillez remplir tous les champs correctement.');
                        return;
                    }

                    // Calcul du BMI
                    const bmi = (weight / (height * height)).toFixed(2);

                    // Calcul des calories selon le genre
                    let tmb;
                    if (gender === 'male') {
                        // Formule pour les hommes
                        tmb = 10 * weight + 6.25 * (height * 100) - 5 * age + 5;
                    } else {
                        // Formule pour les femmes
                        tmb = 10 * weight + 6.25 * (height * 100) - 5 * age - 161;
                    }

                    const calories = Math.round(tmb * activityLevel);

                    // Affichage des résultats
                    document.getElementById('bmiResult').innerHTML = `BMI : <strong>${bmi}</strong>`;
                    document.getElementById('caloriesResult').innerHTML = `Calories nécessaires/jour : <strong>${calories}</strong>`;
                });
            </script>

            <!-- Section : Macros offertes chaque jour -->
        <div class="profile__section">
            <h2>Macros Offertes Chaque Jour</h2>

            <div class="macros">
                <label for="day">Choisissez un jour :</label>
                <select id="day">
                    <option value="Monday">Lundi</option>
                    <option value="Tuesday">Mardi</option>
                    <option value="Wednesday">Mercredi</option>
                    <option value="Thursday">Jeudi</option>
                    <option value="Friday">Vendredi</option>
                    <option value="Saturday">Samedi</option>
                    <option value="Sunday">Dimanche</option>
                </select>

                <button id="showMacros">Afficher les Macros</button>

                <div class="macros__info" id="macrosInfo" style="display: none;">
                    <h3>Informations Nutritionnelles :</h3>
                    <p>Protéines : <span id="protein">-</span> g</p>
                    <p>Glucides : <span id="carbs">-</span> g</p>
                    <p>Lipides : <span id="fats">-</span> g</p>
                    <p>Calories : <span id="calories">-</span> kcal</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('showMacros').addEventListener('click', function() {
            const macros = {
                Monday: { protein: 114, carbs: 197, fats: 20, calories: 1453 },
                Tuesday: { protein: 72, carbs: 176, fats: 21, calories: 1196 },
                Wednesday: { protein: 85, carbs: 131, fats: 13, calories: 988 },
                Thursday: { protein: 45, carbs: 111, fats: 28, calories: 872 },
                Friday: { protein: 62, carbs: 146, fats: 9, calories: 1000 },
                Saturday: { protein: 50, carbs: 72, fats: 20, calories: null },
                Sunday: { protein: 58, carbs: 163, fats: 28, calories: 1140 },
            };

            const selectedDay = document.getElementById('day').value;
            const dayMacros = macros[selectedDay];

            document.getElementById('protein').textContent = dayMacros.protein;
            document.getElementById('carbs').textContent = dayMacros.carbs;
            document.getElementById('fats').textContent = dayMacros.fats;
            document.getElementById('calories').textContent = dayMacros.calories;

            document.getElementById('macrosInfo').style.display = 'block';
        });
    </script>


        </div>
    </div>

    <script>
        // Variables globales
        // Récupérer l'ID de l'utilisateur depuis le localStorage
        let utilisateurId = localStorage.getItem('utilisateurId');

        if (!utilisateurId) {
            alert("Utilisateur non connecté. Veuillez vous connecter.");
            window.location.href = 'login.html';  // Rediriger vers la page de connexion si l'utilisateur n'est pas connecté
        }

        // Variables globales
        let joursSelectionnes = new Set();
        let activiteSelectionnee = null;

        // Gestion des horaires cliquables
        document.querySelectorAll('.calendar__day').forEach(day => {
        day.addEventListener('click', () => {
            day.classList.toggle('selected');
            const horaire = day.textContent;
            const jour = Array.from(day.parentElement.children).indexOf(day) % 7;
            const horaireComplet = `${jour} ${horaire}`;

            if (joursSelectionnes.has(horaireComplet)) {
                joursSelectionnes.delete(horaireComplet);
            } else {
                joursSelectionnes.add(horaireComplet);
            }
        });
    });

// Sauvegarder les horaires
document.getElementById('sauvegarder-horaires').addEventListener('click', () => {
    const horaires = Array.from(joursSelectionnes);

    fetch('http://localhost:5000/horaires', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            utilisateur_id: utilisateurId,
            horaires: horaires
        })
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Erreur réseau');
        }
        return response.json();
    })
    .then(data => {
        if (data.message) {
            alert(data.message);
        } else {
            alert("Réponse inattendue du serveur.");
        }
    })
    .catch(error => {
        console.error('Erreur:', error);
        alert("Une erreur s'est produite. Vérifiez la console pour plus de détails.");
    });
});

// Gestion des activités cliquables
document.querySelectorAll('.activity').forEach(activity => {
    activity.addEventListener('click', () => {
        // Désélectionner toutes les activités
        document.querySelectorAll('.activity').forEach(a => a.classList.remove('selected'));
        // Sélectionner l'activité cliquée
        activity.classList.add('selected');
        // Mettre à jour la variable activiteSelectionnee
        activiteSelectionnee = activity.getAttribute('data-activite-id');
    });
});

// Choisir une activité
document.getElementById('choisir-activite').addEventListener('click', () => {
    if (!activiteSelectionnee) {
        alert('Veuillez sélectionner une activité.');
        return;
    }

    fetch('http://localhost:5000/preferences', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            utilisateur_id: utilisateurId,
            activite_id: activiteSelectionnee
        })
    })
    .then(response => {
        if (!response.ok) {
            console.error('Erreur HTTP:', response.status, response.statusText);
            throw new Error('Erreur réseau');
        }
        return response.json();
    })
    .then(data => {
        if (data.message) {
            alert(data.message);
        } else {
            alert("Réponse inattendue du serveur.");
        }
    })
    .catch(error => {
        console.error('Erreur:', error);
        alert("Une erreur s'est produite. Vérifiez la console pour plus de détails.");
    });
});

// Définir l'objectif hebdomadaire
document.getElementById('definir-objectif').addEventListener('click', () => {
    const formData = {
        utilisateur_id: utilisateurId,
        nombre_seances: document.getElementById('nombre_seances').value,
        calories_a_bruler: document.getElementById('calories_a_bruler').value,
        objectif_sante: document.getElementById('objectif_sante').value,
        notes: document.getElementById('notes').value
    };

    fetch('http://localhost:5000/objectifs', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(formData)
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Erreur réseau');
        }
        return response.json();
    })
    .then(data => {
        if (data.message) {
            alert(data.message);
        } else {
            alert("Réponse inattendue du serveur.");
        }
    })
    .catch(error => {
        console.error('Erreur:', error);
        alert("Une erreur s'est produite. Vérifiez la console pour plus de détails.");
    });
});

// Enregistrer l'objectif de santé
document.getElementById('enregistrer-objectif').addEventListener('click', () => {
    const objectifSante = document.getElementById('objectif_sante').value;
    const notes = document.getElementById('notes').value;

    if (!objectifSante) {
        alert('Veuillez remplir tous les champs.');
        return;
    }

    fetch('http://localhost:5000/objectifs', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            utilisateur_id: utilisateurId,
            objectif_sante: objectifSante,
            notes: notes
        })
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Erreur réseau');
        }
        return response.json();
    })
    .then(data => {
        if (data.message) {
            alert(data.message);
        } else {
            alert("Réponse inattendue du serveur.");
        }
    })
    .catch(error => {
        console.error('Erreur:', error);
        alert("Une erreur s'est produite. Vérifiez la console pour plus de détails.");
    });
});
    </script>
</body>
</html>